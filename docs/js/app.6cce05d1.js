(function(t){function e(e){for(var a,r,i=e[0],c=e[1],l=e[2],u=0,h=[];u<i.length;u++)r=i[u],n[r]&&h.push(n[r][0]),n[r]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);d&&d(e);while(h.length)h.shift()();return o.push.apply(o,l||[]),s()}function s(){for(var t,e=0;e<o.length;e++){for(var s=o[e],a=!0,i=1;i<s.length;i++){var c=s[i];0!==n[c]&&(a=!1)}a&&(o.splice(e--,1),t=r(r.s=s[0]))}return t}var a={},n={app:0},o=[];function r(e){if(a[e])return a[e].exports;var s=a[e]={i:e,l:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=t,r.c=a,r.d=function(t,e,s){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(s,a,function(e){return t[e]}.bind(null,a));return s},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/nem2-wallet-workshop-answer/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var d=c;o.push([0,"chunk-vendors"]),s()})({0:function(t,e,s){t.exports=s("cd49")},"00c6":function(t,e,s){"use strict";var a=s("c325"),n=s.n(a);n.a},1:function(t,e){},2:function(t,e){},3:function(t,e){},4:function(t,e){},5:function(t,e){},6358:function(t,e,s){"use strict";var a=s("669e"),n=s.n(a);n.a},"669e":function(t,e,s){},"7faf":function(t,e,s){"use strict";var a=s("8fba"),n=s.n(a);n.a},"89d8":function(t,e,s){},"8fba":function(t,e,s){},c325:function(t,e,s){},cd49:function(t,e,s){"use strict";s.r(e);var a=s("2b0e"),n=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("header",[s("router-link",{staticStyle:{"text-decoration":"none",color:"white"},attrs:{to:"/"}},[s("span",[t._v("NEM2 wallet")])])],1),s("div",{staticClass:"main__content"},[s("v-fade-transition",{attrs:{mode:"out-in"}},[s("router-view")],1)],1)])},o=[],r=(s("7faf"),s("2877")),i={},c=Object(r["a"])(i,n,o,!1,null,null,null),l=c.exports,d=s("8c4f"),u=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[null!==t.wallet?s("v-card",[s("v-container",{attrs:{fluid:""}},[s("v-card",{attrs:{flat:""}},[s("v-card-actions",[s("v-card-title",[s("h3",[t._v("Network")])])],1),s("div",[s("table",{staticClass:"table__list",attrs:{border:"1"}},[s("tr",[s("td",{staticClass:"table__key",attrs:{width:"15%"}},[t._v("net")]),s("td",{staticClass:"table__value",attrs:{width:"85%"}},[t._v(t._s(t.network.net))])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"15%"}},[t._v("endpoint")]),s("td",{staticClass:"table__value",attrs:{width:"85%"}},[s("a",{attrs:{href:t.network.explorer,target:"_blank"}},[t._v(t._s(t.network.endpoint))])])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"15%"}},[t._v("faucet")]),s("td",{staticClass:"table__value",attrs:{width:"85%"}},[s("a",{attrs:{href:t.network.faucetUrl,target:"_blank"}},[t._v(t._s(t.network.faucetUrl))])])])])]),s("v-card-actions",[s("v-card-title",[s("h3",[t._v("Address")])])],1),s("v-card-text",{staticStyle:{"word-break":"break-all"}},[t._v(t._s(t.wallet.address))]),s("v-card",{attrs:{flat:""}},[s("qriously",{attrs:{size:200},model:{value:t.qrJson,callback:function(e){t.qrJson=e},expression:"qrJson"}})],1),s("div",[s("a",{attrs:{href:"#"},on:{click:function(){return t.isShowPrivateKey=!t.isShowPrivateKey}}},[t._v("Show PrivateKey")]),t.isShowPrivateKey?s("div",{staticStyle:{margin:"8px"}},[s("p",{staticStyle:{"word-break":"break-all"}},[t._v(t._s(t.wallet.privateKey))])]):t._e()])],1),s("v-card",{attrs:{flat:""}},[s("v-card-actions",[s("v-card-title",[s("h3",[t._v("Menu")])])],1),s("ul",{staticClass:"menu__list"},[s("li",[s("router-link",{attrs:{to:"./asset_exchange_page"}},[t._v("\n                Exchange Asset\n              ")])],1)])],1),s("v-card",{attrs:{flat:""}},[s("v-card-actions",[s("v-card-title",[s("h3",[t._v("Balance")])]),s("v-spacer"),s("v-btn",{attrs:{fab:"",small:"",text:"",loading:t.isLoading},on:{click:function(e){return t.onLoadBalance()}}},[s("v-icon",[t._v("cached")])],1)],1),0!==t.assets.length?s("div",[s("v-data-table",{attrs:{items:t.assets,"hide-default-footer":"","no-data-text":""},scopedSlots:t._u([{key:"item",fn:function(e){return[s("tr",{on:{click:function(s){return t.onClickAsset(e.item)}}},[s("td",{attrs:{width:"50%"}},[t._v(t._s(e.item.mosaicId))]),s("td",{attrs:{width:"50%"}},[t._v(t._s(e.item.relativeAmount))])])]}}],null,!1,2510852479)})],1):s("div",[s("v-card-text",[t._v("0 xem")])],1),s("v-card-actions",[s("v-card-title",[s("h3",[t._v("Send")])])],1),s("v-form",{staticStyle:{margin:"4px 26px"}},[s("v-text-field",{attrs:{label:"currency",disabled:""},model:{value:t.sendAsset.mosaicId,callback:function(e){t.$set(t.sendAsset,"mosaicId",e)},expression:"sendAsset.mosaicId"}}),s("v-text-field",{attrs:{label:"address",required:"",placeholder:"SADW6WXZVIUWIJ6RAWFSM4F4SJRUBRVOARXXIFSH"},model:{value:t.sendAsset.address,callback:function(e){t.$set(t.sendAsset,"address",e)},expression:"sendAsset.address"}}),s("v-text-field",{attrs:{label:"amount",type:"number",required:""},model:{value:t.sendAsset.relativeAmount,callback:function(e){t.$set(t.sendAsset,"relativeAmount",e)},expression:"sendAsset.relativeAmount"}}),s("v-text-field",{attrs:{label:"message",placeholder:"Hello"},model:{value:t.sendAsset.message,callback:function(e){t.$set(t.sendAsset,"message",e)},expression:"sendAsset.message"}})],1),s("v-flex",[s("v-btn",{staticClass:"white--text",attrs:{color:"blue",loading:t.isLoading,disabled:t.isLoading},on:{click:function(e){return t.onSend()}}},[t._v("SEND")])],1),s("v-flex",[s("v-card-actions",[s("v-card-title",[s("h3",[t._v("Result")])])],1),t._l(t.errorMessages,function(e,a){return s("div",{key:a},[!0!==e?s("div",{staticClass:"errorLabel"},[t._v(t._s(e))]):t._e()])}),s("p",{staticStyle:{"word-break":"break-all"},domProps:{innerHTML:t._s(t.resultMessage)}})],2),s("v-flex",[s("v-card-actions",{staticStyle:{"word-break":"break-all"}},[s("v-card-title",[s("h3",[t._v("Transaction history")])]),t._v("\n              "+t._s(t.transactionHistory.length)+"\n              "),s("v-spacer"),s("v-btn",{attrs:{fab:"",small:"",text:"",loading:t.isHistoryLoading},on:{click:function(e){return t.onLoadTransactionHistory(!0)}}},[s("v-icon",[t._v("cached")])],1)],1),s("div",{staticStyle:{margin:"4px 20px"}},[s("v-data-table",{attrs:{headers:t.historyHeaders,items:t.transactionHistory,options:t.pagination,"hide-default-footer":"","no-data-text":""},on:{"update:options":function(e){t.pagination=e}},scopedSlots:t._u([{key:"item",fn:function(e){return[s("tr",{on:{click:function(s){return t.onClickHistory(e.item)}}},[s("td",{attrs:{width:"20%"}},[t._v(t._s(e.item.amount))]),s("td",{attrs:{width:"50%"}},[t._v(t._s(e.item.hash))]),s("td",{attrs:{width:"30%"}},[t._v(t._s(t._f("dateFormat")(e.item.date)))])])]}}],null,!1,4250521784)}),s("v-btn",{staticClass:"white--text",attrs:{color:"deep-orange lighten-3",loading:t.isHistoryLoading,disabled:t.isHistoryLoading},on:{click:function(e){return t.onLoadTransactionHistory()}}},[t._v("MORE")])],1)],1)],1)],1)],1):t._e()],1)],1)},h=[],g=s("9ab4"),p=s("60a3"),m=s("2f62"),v=s("340b");class b{constructor(){this.address="",this.mosaicId="",this.message=void 0,this.relativeAmount=0,this.divisibility=6}clear(){this.address="",this.message=void 0,this.relativeAmount=0}getRawAmount(){return this.relativeAmount*Math.pow(10,this.divisibility)}}var w=s("10bf"),y=s.n(w);class f{static qrJson(t,e,s,a,n,o){const r={type:e,data:{name:s,addr:a,amount:n*this.divisibility(),msg:o},v:t};return y.a.codeToString(y.a.convert(this.getStr2Array(JSON.stringify(r)),"UTF8"))}static divisibility(){return Math.pow(10,6)}static networkLabel(t){switch(t){case 104:return"MAIN_NET";case 152:return"TEST_NET";case 96:return"MIJIN";case 144:return"MIJIN_TEST";default:return"Unknow"}}static rentalBlock(t){return 86400*t/15}static getStr2Array(t){const e=[];for(let s=0;s<t.length;s++)e.push(t.charCodeAt(s));return e}}let A=class extends p["d"]{constructor(){super(...arguments),this.balance=0,this.assets=[],this.sendAsset=new b,this.wallet=null,this.qrJson="",this.isShowPrivateKey=!1,this.errorMessages=[],this.resultMessage="",this.network={net:f.networkLabel(Number("144")),endpoint:"https://catapult-test.opening-line.jp:3001",explorer:"http://catapult-test.opening-line.jp:8000",faucetUrl:"https://ol-catapult-faucet.herokuapp.com/"},this.balanceHeaders=[{text:"",value:"currency",align:"center"},{text:"",value:"amount",align:"center"}],this.historyHeaders=[{text:"amount",value:"amount"},{text:"txHash",value:"hash"},{text:"date",value:"date"}],this.isHistoryLoading=!1,this.pagination={descending:!0,itemsPerPage:-1},this.transactionHistory=[],this.aggregateConsigHeaders=[{text:"distributer",value:"distributerAddress"},{text:"distributer get nem",value:"distributerGetAmount"},{text:"asset receiver",value:"receiverAddress"},{text:"asset",value:"receiverGetCurrency"},{text:"asset amount",value:"receiverGetAmount"},{text:"deadline",value:"deadline"}],this.isAggregateConsigLoading=!1,this.aggregateConsigs=[],this.selectedAggregateConsig=null}onValueChange(t,e){this.qrJson=f.qrJson(2,2,"nem2-wallet",t,0,"")}mounted(){p["d"].prototype.$toast("Hello NEM2 wallet"),this.configure()}async configure(){try{this.wallet=await this.loadWalletUseCase.execute(),this.onLoadBalance(),this.onLoadTransactionHistory()}catch(t){console.error(t)}}async onLoadBalance(){this.$store.commit("startLoading");try{if(null===this.wallet)return;this.assets=await this.loadBalanceUseCase.execute(this.wallet.address),console.log("balance",this.assets),0!==this.assets.length&&(this.sendAsset.mosaicId=this.assets[0].mosaicId)}catch(t){console.error("balance",t)}this.$store.commit("stopLoading")}async onSend(){this.$store.commit("startLoading");try{if(this.resultMessage="",0!==this.validation().length)throw new Error("Cloud not send coin.");this.sendAsset.relativeAmount=Number(this.sendAsset.relativeAmount);const e=await this.sendCoinUseCase.execute(this.sendAsset);console.log("sendAsset",e),this.resultMessage=`SUCCESS: ${e.hash}`}catch(t){console.error("sendAsset",t),this.resultMessage=`FAILED: ${t.message}`}p["d"].prototype.$toast(this.resultMessage),this.$store.commit("stopLoading")}onClickAsset(t){console.log("onClickAsset",t),this.sendAsset.mosaicId=t.mosaicId,this.sendAsset.divisibility=t.divisibility}onClickHistory(t){console.log("onClickHistory",t)}async onLoadTransactionHistory(t=!1){this.isHistoryLoading=!0;try{!0===t&&(this.transactionHistory=[],this.nextPagingTransactionId=void 0);const s=await this.loadTransactionHistoryUseCase.executeTransferHistoryAll(30,this.nextPagingTransactionId);console.log("history",s),0!==s.histories.length&&(this.nextPagingTransactionId=s.nextPagingTransactionId),this.transactionHistory.push(...s.histories)}catch(e){console.error("onLoadTransactionHistory",e)}this.isHistoryLoading=!1}async onAggregateApproval(){this.$store.commit("startLoading");try{if(null===this.selectedAggregateConsig)throw new Error("Not select aggregate consig yet.");this.resultMessage="";const e=await this.assetExchangeUseCase.approvalConsigAggregate(this.selectedAggregateConsig);console.log("onAggregateApproval",e),this.resultMessage=e,this.selectedAggregateConsig=null,this.onLoadAggregateConsigList()}catch(t){console.error("onAggregateApproval",t),this.resultMessage=`FAILED: ${t.message}`}p["d"].prototype.$toast(this.resultMessage),this.$store.commit("stopLoading")}onClickAggregateConsig(t){console.log("onClickAggregateConsig",t),t.distributerAddress===this.wallet.address?this.selectedAggregateConsig=t:this.resultMessage="The approver of consig aggregate tx is not you."}async onLoadAggregateConsigList(t=!1){this.isAggregateConsigLoading=!0;try{const t=await this.assetExchangeUseCase.loadAggregateBondedTransactions(100,void 0);this.aggregateConsigs=t.consigs}catch(e){console.error("onLoadAggregateConsigList",e)}this.isAggregateConsigLoading=!1}validation(){return this.errorMessages=[],console.log(this.sendAsset),40!==this.sendAsset.address.length&&this.errorMessages.push('Address (except "-") is 40 characters'),/^[a-zA-Z0-9-]+$/.test(this.sendAsset.address)||this.errorMessages.push("Invalid input"),void 0!==this.sendAsset.message&&this.sendAsset.message.length>1024&&this.errorMessages.push("Maximum number of characters in message has exceeded"),this.errorMessages}addressLabel(t){return this.wallet.address===t?"YOU":t}clear(){this.sendAsset.clear()}};g["a"]([Object(p["b"])("LoadBalanceUseCase")],A.prototype,"loadBalanceUseCase",void 0),g["a"]([Object(p["b"])("LoadWalletUseCase")],A.prototype,"loadWalletUseCase",void 0),g["a"]([Object(p["b"])("SendCoinUseCase")],A.prototype,"sendCoinUseCase",void 0),g["a"]([Object(p["b"])("LoadTransactionHistoryUseCase")],A.prototype,"loadTransactionHistoryUseCase",void 0),g["a"]([Object(p["b"])("AssetExchangeUseCase")],A.prototype,"assetExchangeUseCase",void 0),g["a"]([Object(p["e"])("wallet.address")],A.prototype,"onValueChange",null),A=g["a"]([Object(p["a"])({name:"HomePage",computed:Object(m["b"])(["isLoading"]),filters:{dateFormat(t){return Object(v["format"])(t,"YYYY/MM/DD HH:mm:ss")}}})],A);var _=A,C=_,x=(s("6358"),Object(r["a"])(C,u,h,!1,null,"78a39637",null)),H=x.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"transactionpage"},[null!==t.transactionHistory?s("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[s("v-flex",[s("div",{staticStyle:{margin:"8px"}},[s("h2",[t._v("Transaction detail")])]),s("table",{staticClass:"table__list",attrs:{border:"1"}},[s("tr",[s("td",{staticClass:"table__key",attrs:{width:"30%"}},[t._v("id")]),s("td",{staticClass:"table__value",attrs:{width:"70%"}},[t._v(t._s(t.transactionHistory.id))])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"30%"}},[t._v("hash")]),s("td",{staticClass:"table__value",attrs:{width:"70%"}},[t._v(t._s(t.transactionHistory.hash))])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"30%"}},[t._v("fromAddress")]),s("td",{staticClass:"table__value",attrs:{width:"70%"}},[t._v(t._s(t.transactionHistory.fromAddress))])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"30%"}},[t._v("toAddress")]),s("td",{staticClass:"table__value",attrs:{width:"70%"}},[t._v(t._s(t.transactionHistory.toAddress))])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"30%"}},[t._v("amount")]),s("td",{staticClass:"table__value",attrs:{width:"70%"}},[t._v(t._s(t.transactionHistory.amount))])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"30%"}},[t._v("fee")]),s("td",{staticClass:"table__value",attrs:{width:"70%"}},[t._v(t._s(t.transactionHistory.fee))])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"30%"}},[t._v("message")]),s("td",{staticClass:"table__value",attrs:{width:"70%"}},[t._v(t._s(t.transactionHistory.message))])]),s("tr",[s("td",{staticClass:"table__key",attrs:{width:"30%"}},[t._v("date")]),s("td",{staticClass:"table__value",attrs:{width:"70%"}},[t._v(t._s(t._f("dateFormat")(t.transactionHistory.date)))])])])])],1):t._e()],1)},S=[];let T=class extends p["d"]{constructor(){super(...arguments),this.transactionHistory=null}mounted(){this.configure(),console.log(this.transactionId)}async configure(){this.onLoadTransactionHistory()}async onLoadTransactionHistory(){if(this.$store.commit("startLoading"),void 0!==this.transactionId){try{this.transactionHistory=await this.loadTransactionHistoryUseCase.executeTransferHistory(this.transactionId),console.log(this.transactionHistory)}catch(t){console.error(t)}this.$store.commit("stopLoading")}}};g["a"]([Object(p["b"])("LoadTransactionHistoryUseCase")],T.prototype,"loadTransactionHistoryUseCase",void 0),g["a"]([Object(p["c"])()],T.prototype,"transactionId",void 0),T=g["a"]([Object(p["a"])({name:"TransactionPage",computed:Object(m["b"])(["isLoading"]),filters:{dateFormat(t){return Object(v["format"])(t,"YYYY/MM/DD HH:mm:ss")}}})],T);var O=T,j=O,N=(s("00c6"),Object(r["a"])(j,k,S,!1,null,"5005f862",null)),M=N.exports,I=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"assetexchangepage"},[s("v-flex",{attrs:{xs12:"",sm6:"","offset-sm3":""}},[s("v-flex",{staticStyle:{"margin-top":"24px"}},[s("h1",[t._v("Create asset")])]),s("v-flex",{staticStyle:{"margin-top":"8px"}},[s("v-card",[s("v-card-actions",[s("v-card-title",[s("h4",[t._v("Create")])])],1),s("v-form",{staticStyle:{margin:"0 26px"}},[s("v-text-field",{attrs:{label:"name",placeholder:"shohei-ticket",required:""},model:{value:t.assetForm.name,callback:function(e){t.$set(t.assetForm,"name",e)},expression:"assetForm.name"}}),s("v-text-field",{attrs:{label:"supply max amount",type:"number",required:""},model:{value:t.assetForm.maxAmount,callback:function(e){t.$set(t.assetForm,"maxAmount",e)},expression:"assetForm.maxAmount"}})],1),s("v-flex",{staticStyle:{"padding-bottom":"20px"}},[s("v-btn",{staticClass:"white--text",attrs:{color:"blue",loading:t.isLoading,disabled:t.isLoading},on:{click:function(e){return t.onCreateAsset()}}},[t._v("CREATE")])],1)],1)],1)],1)],1)},L=[];class P{constructor(t,e,s,a,n,o,r){this.namespace=t,this.maxAmount=e,this.exchangeAmount=s,this.supplyMutable=a,this.transferable=n,this.divisibility=o,this.durationCount=r}}let F=class extends p["d"]{constructor(){super(...arguments),this.assetForm={name:"",maxAmount:0,exchangeNemAmount:0}}async onCreateAsset(){this.$store.commit("startLoading");let t="";try{const s=this.assetForm.name,a=Number(this.assetForm.maxAmount),n=Number(this.assetForm.exchangeNemAmount),o=new P(s,a,n,!0,!0,0);console.log("onCreateAsset",o),t=await this.assetExchangeUseCase.createAsset(o),this.clearForm()}catch(e){console.error("onCreateAsset",e),t=e.message}p["d"].prototype.$toast(t),this.$store.commit("stopLoading")}clearForm(){this.assetForm={name:"",maxAmount:0,exchangeNemAmount:0}}};g["a"]([Object(p["b"])("AssetExchangeUseCase")],F.prototype,"assetExchangeUseCase",void 0),F=g["a"]([Object(p["a"])({name:"AssetExchangePage",computed:Object(m["b"])(["isLoading"]),filters:{dateFormat(t){return Object(v["format"])(t,"YYYY/MM/DD HH:mm:ss")}}})],F);var E=F,U=E,R=(s("dc9d"),Object(r["a"])(U,I,L,!1,null,"2316f66e",null)),K=R.exports;a["default"].use(d["a"]);var $=new d["a"]({mode:"history",base:"/nem2-wallet-workshop-answer/",routes:[{path:"/",name:"home_page",component:H},{path:"/transaction_page/:transactionId",name:"transaction_page",component:M,props:!0},{path:"/asset_exchange_page",name:"asset_exchange_page",component:K}]});a["default"].use(m["a"]);var B=new m["a"].Store({state:{isLoading:!1},mutations:{stopLoading(t){t.isLoading=!1},startLoading(t){t.isLoading=!0}},actions:{}}),W=s("9483");Object(W["a"])("/nem2-wallet-workshop-answer/service-worker.js",{ready(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered(){console.log("Service worker has been registered.")},cached(){console.log("Content has been cached for offline use.")},updatefound(){console.log("New content is downloading.")},updated(){console.log("New content is available; please refresh.")},offline(){console.log("No internet connection found. App is running in offline mode.")},error(t){console.error("Error during service worker registration:",t)}});s("cc20");var D=s("7869"),q=s.n(D),G=s("6112"),J=s.n(G);class Y{constructor(t,e){this.walletRepository=t,this.namespaceRepository=e}async execute(t){try{return await this.walletRepository.loadBalance(t)}catch(e){throw e}}}class V{constructor(t){this.repository=t}async execute(){const t=await this.repository.loadWallet();return void 0!==t?t:await this.repository.createWallet()}}class Z{constructor(t,e){this.transactionRepository=t,this.walletRepository=e}async execute(t){try{const s=await this.walletRepository.loadWallet(),a=s.privateKey;return await this.transactionRepository.sendAsset(a,t)}catch(e){throw e}}}class X{constructor(t,e){this.transactionRepository=t,this.walletRepository=e}async executeTransferHistory(t){try{return await this.transactionRepository.transactionHistory(t)}catch(e){throw e}}async executeTransferHistoryAll(t,e){try{const a=await this.walletRepository.loadWallet(),n=a.publicKey;return await this.transactionRepository.transactionHistoryAll(n,t,e)}catch(s){throw s}}}class z{constructor(t,e,s,a,n){this.receiverPrivateKey=t,this.exchangeNemAmount=e,this.distributorPublicKey=s,this.distributeRawAmount=a,this.distributeAssetId=n}}class Q{constructor(t,e,s,a,n){this.transactionRepository=t,this.walletRepository=e,this.aggregateRepository=s,this.mosaicRepository=a,this.namespaceRepository=n}async createAsset(t){let e="";return e}async exchangeAsset(t,e,s,a){let n;try{const r=await this.walletRepository.loadWallet(),i=r.privateKey,c=await this.mosaicRepository.loadMosaicInfo(a),l=s*Math.pow(10,c.divisibility),d=new z(i,t,e,l,a),u=await this.aggregateRepository.requestAggregateEscrowAsset(d);n=`SUCCESS: ${u.hash}`,console.log("aggregateEscrowAsset",n)}catch(o){throw o}return n}async approvalConsigAggregate(t){let e;try{const a=await this.walletRepository.loadWallet(),n=a.privateKey,o=await this.aggregateRepository.approvalConsigAggregate(n,t);e=`SUCCESS: ${o.hash}`,console.log("consigAggregate",e)}catch(s){throw s}return e}async approvalConsigAggregateAll(){let t;try{const s=await this.walletRepository.loadWallet(),a=s.privateKey,n=await this.aggregateRepository.approvalConsigAggregateAll(a);t=`SUCCESS: ${n.hash}`,console.log("consigAggregate",t)}catch(e){throw e}return t}async loadAggregateBondedTransactions(t,e){let s;try{const n=await this.walletRepository.loadWallet(),o=n.privateKey;s=await this.aggregateRepository.aggregateBondedTransactions(o,t,e),console.log("loadAggregateBondedTransactions",s)}catch(a){throw a}return s}}var tt=s("db6a"),et=s("1758"),st=s("ebb6"),at=s("a6c5");class nt{constructor(t,e,s,a){this.address=t,this.publicKey=e,this.privateKey=s,this.networkType=a}toJSON(){return{address:this.address,publicKey:this.publicKey,privateKey:this.privateKey,networkType:this.networkType}}}class ot{constructor(t){this.nemNode=t,this.accountHttp=new tt["AccountHttp"](t.endpoint),this.mosaicHttp=new tt["MosaicHttp"](t.endpoint),this.mosaicService=new tt["MosaicService"](this.accountHttp,this.mosaicHttp),this.localStorageKey="nem2-wallet-workshop"}async createWallet(){return new nt}async loadWallet(){}async loadAccount(t){const e=tt["Address"].createFromRawAddress(t);return new Promise((t,s)=>{this.accountHttp.getAccountInfo(e).subscribe(e=>{e.mosaics.forEach(t=>{console.log("mosaic",t.id.toHex(),t.amount.compact())}),t(e)},t=>s(t))})}async loadBalance(t){return new Promise((t,e)=>{t([])})}async loadBalanceAndNamespace(t){return new Promise((e,s)=>{const a=tt["Address"].createFromRawAddress(t);this.mosaicService.mosaicsAmountViewFromAddress(a).pipe(Object(et["a"])(),Object(st["a"])(t=>{const e=t.map(t=>t.mosaicInfo.mosaicId);return console.log("mosaicIds",e),this.mosaicHttp.getMosaicsNames(e)}),Object(at["a"])(t=>t)).subscribe(t=>{console.log(t),e(t)},t=>console.error(t))})}}var rt,it=s("5670");(function(t){t[t["Unconfirm"]=0]="Unconfirm",t[t["Confirm"]=1]="Confirm"})(rt||(rt={}));class ct{constructor(t,e,s){this.message=t,this.hash=e,this.confirmType=s}}class lt{constructor(t,e){this.message=t,this.hash=e}}class dt{constructor(t){this.endpoint=t,this.listener=new tt["Listener"](this.endpoint,WebSocket)}async loadStatus(t,e){try{return await this._loadStatus(t,e)}catch(s){throw s}}_loadStatus(t,e){return new Promise((s,a)=>{const n=tt["Address"].createFromRawAddress(t);this.listener.open().then(()=>{this.listener.status(n).pipe(Object(it["a"])(t=>t.hash===e),Object(st["a"])(t=>new lt(t.status,t.hash))).subscribe(t=>{console.error("loadStatus status",t),a(t)}),this.listener.unconfirmedAdded(n).pipe(Object(it["a"])(t=>void 0!==t.transactionInfo&&t.transactionInfo.hash===e),Object(st["a"])(t=>new ct("SUCCESS",t.transactionInfo.hash,rt.Unconfirm))).subscribe(t=>{console.log("loadStatus unconfirmedAdded",t),s(t)},t=>console.error("loadStatus unconfirmedAdded",t)),this.listener.confirmed(n).pipe(Object(it["a"])(t=>void 0!==t.transactionInfo&&t.transactionInfo.hash===e),Object(st["a"])(t=>new ct("SUCCESS",t.transactionInfo.hash,rt.Confirm))).subscribe(t=>{console.log("loadStatus confirmed",t),s(t)},t=>console.error("loadStatus confirmed",t))})})}}class ut{constructor(t,e,s,a,n,o,r,i,c){this.id=t,this.amount=e,this.fee=s,this.toAddress=a,this.fromAddress=n,this.message=o,this.date=r,this.hash=i,this.rawValue=c}}class ht{constructor(t){this.nemNode=t,this.accountHttp=new tt["AccountHttp"](t.endpoint),this.transactionHttp=new tt["TransactionHttp"](t.endpoint),this.blockHttp=new tt["BlockHttp"](t.endpoint),this.listenerWrapper=new dt(t.wsEndpoint),this.mosaicHttp=new tt["MosaicHttp"](t.endpoint)}async sendAsset(t,e){return new Promise((t,e)=>{t(void 0)})}async transactionHistory(t){return new Promise((e,s)=>{let a;this.transactionHttp.getTransaction(t).pipe(Object(st["a"])(t=>{return console.log("transactionHistory",t),t}),Object(it["a"])(t=>t instanceof tt["TransferTransaction"]),Object(st["a"])(t=>{return a=t,a}),Object(st["a"])(t=>this.blockHttp.getBlockByHeight(t.transactionInfo.height.compact())),Object(at["a"])(t=>t),Object(st["a"])(t=>new ut(a.transactionInfo.id,0!==a.mosaics.length?a.mosaics[0].amount.compact()/f.divisibility():0,a.maxFee.compact(),a.recipient instanceof tt["Address"]?a.recipient.plain():"",void 0!==a.signer?a.signer.address.plain():"",a.message.payload,void 0!==t?new Date(t.timestamp.compact()+Date.UTC(2016,3,1,0,0,0,0)):void 0,a.transactionInfo.hash,a))).subscribe(t=>e(t),t=>s(t))})}async transactionHistoryAll(t,e,s){return new Promise((t,e)=>{t(void 0)})}async unconfirmedTransactions(t,e,s){return new Promise((a,n)=>{const o=tt["PublicAccount"].createFromPublicKey(t,this.nemNode.network);this.accountHttp.unconfirmedTransactions(o,new tt["QueryParams"](e,s,tt["Order"].DESC)).pipe(Object(st["a"])(t=>{return console.log("unconfirmedTransactions",t),t})).subscribe(t=>a(t),t=>n(t))})}}var gt=s("f74f"),pt=s("17f5"),mt=s("f59d");class vt{constructor(t,e=[]){this.nextPagingTransactionId=t,this.consigs=e}}class bt{constructor(){this.distributerGetCurrency="",this.distributerGetAmount=0,this.distributerAddress="",this.receiverGetCurrency="",this.receiverGetAmount=0,this.receiverAddress="",this.deadline=void 0,this.aggregateTransaction=void 0}}class wt{constructor(t,e){this.mosaicId=t,this.divisibility=e}}var yt=s("f551");class ft{constructor(t){this.nemNode=t,this.accountHttp=new tt["AccountHttp"](t.endpoint),this.transactionHttp=new tt["TransactionHttp"](t.endpoint),this.mosaicHttp=new tt["MosaicHttp"](t.endpoint),this.listenerWrapper=new dt(t.wsEndpoint)}async requestComplete(t,e){return new Promise((t,e)=>{t(void 0)})}async requestAggregateEscrowAsset(t){return new Promise((e,s)=>{const a=tt["Account"].createFromPrivateKey(t.receiverPrivateKey,this.nemNode.network),n=tt["PublicAccount"].createFromPublicKey(t.distributorPublicKey,this.nemNode.network),o=tt["Deadline"].create(23,yt["ChronoUnit"].HOURS),r=tt["TransferTransaction"].create(o,n.address,[tt["NetworkCurrencyMosaic"].createRelative(t.exchangeNemAmount)],tt["PlainMessage"].create(`send ${t.exchangeNemAmount} currency to distributor`),this.nemNode.network),i=tt["TransferTransaction"].create(o,a.address,[new tt["Mosaic"](new tt["MosaicId"](t.distributeAssetId),tt["UInt64"].fromUint(t.distributeRawAmount))],tt["PlainMessage"].create(`send ${t.distributeRawAmount} (${t.distributeAssetId}) to receiver`),this.nemNode.network),c=tt["AggregateTransaction"].createBonded(o,[r.toAggregate(a.publicAccount),i.toAggregate(n)],this.nemNode.network),l=a.sign(c,this.nemNode.networkGenerationHash);console.log("Aggregate Transaction: ",l.hash);const d=tt["HashLockTransaction"].create(tt["Deadline"].create(),tt["NetworkCurrencyMosaic"].createRelative(10),tt["UInt64"].fromUint(480),l,this.nemNode.network),u=a.sign(d,this.nemNode.networkGenerationHash);this.listenerWrapper.listener.open().then(()=>{this.transactionHttp.announce(u).subscribe(t=>{console.log("hashLockTransactionSigned",t)},t=>s(t)),this.listenerWrapper.listener.confirmed(a.address).pipe(Object(st["a"])(t=>{return console.log("listener confirmed",t),t}),Object(it["a"])(t=>void 0!==t.transactionInfo&&t.transactionInfo.hash===u.hash),Object(at["a"])(t=>this.transactionHttp.announceAggregateBonded(l)),Object(st["a"])(t=>new ct("SUCCESS",u.hash))).subscribe(t=>e(t),t=>{console.error("listener confirmed",t),s(t)})}).catch(t=>s(t))})}async approvalConsigAggregate(t,e){return new Promise((s,a)=>{const n=(t,e)=>{const s=tt["CosignatureTransaction"].create(t);return e.signCosignatureTransaction(s)},o=tt["Account"].createFromPrivateKey(t,this.nemNode.network),r=n(e.aggregateTransaction,o);console.log("cosignatureSignedTransaction",r),this.listenerWrapper.loadStatus(o.address.plain(),r.parentHash).then(t=>s(t)).catch(t=>a(t)),this.transactionHttp.announceAggregateBondedCosignature(r).subscribe(t=>console.log(t),t=>a(t))})}async approvalConsigAggregateAll(t){return new Promise((e,s)=>{const a=(t,e)=>{const s=tt["CosignatureTransaction"].create(t);return e.signCosignatureTransaction(s)},n=tt["Account"].createFromPrivateKey(t,this.nemNode.network);this.accountHttp.aggregateBondedTransactions(n.publicAccount).pipe(Object(at["a"])(t=>t),Object(it["a"])(t=>!t.signedByAccount(n.publicAccount)),Object(st["a"])(t=>a(t,n)),Object(at["a"])(t=>this.transactionHttp.announceAggregateBondedCosignature(t)),Object(st["a"])(t=>new ct("SUCCESS"))).subscribe(t=>e(t),t=>s(t))})}async aggregateBondedTransactions(t,e,s){return new Promise((a,n)=>{const o=tt["Account"].createFromPrivateKey(t,this.nemNode.network);let r,i;this.accountHttp.aggregateBondedTransactions(o.publicAccount,new tt["QueryParams"](e,s,tt["Order"].DESC)).pipe(Object(st["a"])(t=>{return console.log("aggregateBondedTransactions",t),0===t.length&&a(new vt(void 0)),r=new vt(t.slice(-1)[0].transactionInfo.id),t}),Object(at["a"])(t=>t),Object(st["a"])(t=>{return i=t,t.innerTransactions.filter(t=>t instanceof tt["TransferTransaction"]).map(t=>t)}),Object(it["a"])(t=>2===t.length),Object(at["a"])(t=>{const e=t[0].mosaics[0].id,s=t[1].mosaics[0].id;return Object(gt["b"])(Object(pt["a"])(t),e instanceof tt["MosaicId"]?this.mosaicHttp.getMosaic(new tt["MosaicId"](e.toHex())).pipe(Object(st["a"])(t=>new wt(e.toHex(),t.divisibility)),Object(mt["a"])(t=>Object(pt["a"])(new wt(e.toHex(),0)))):Object(pt["a"])(new wt(e.toHex(),6)),s instanceof tt["MosaicId"]?this.mosaicHttp.getMosaic(new tt["MosaicId"](s.toHex())).pipe(Object(st["a"])(t=>new wt(s.toHex(),t.divisibility)),Object(mt["a"])(t=>Object(pt["a"])(new wt(s.toHex(),0)))):Object(pt["a"])(new wt(s.toHex(),6)))}),Object(st["a"])(([t,e,s])=>{console.log("txs",t);const a=new bt;return a.aggregateTransaction=i,a.deadline=new Date(i.deadline.value.atZone(yt["ZoneId"].SYSTEM).toInstant().toEpochMilli()),t.forEach((t,n)=>{if(t.recipient instanceof tt["Address"]){const r=t.recipient;let i=0;i=t.mosaics[0].id.toHex()===e.mosaicId?e.divisibility:s.divisibility,console.log(o.publicAccount.address.plain(),r.plain(),t.message.payload),0===n?(a.distributerAddress=r.plain(),a.distributerGetAmount=t.mosaics[0].amount.compact()/Math.pow(10,i),a.distributerGetCurrency=t.mosaics[0].id.toHex()):(a.receiverAddress=r.plain(),a.receiverGetAmount=t.mosaics[0].amount.compact()/Math.pow(10,i),a.receiverGetCurrency=t.mosaics[0].id.toHex())}}),Object(pt["a"])(a)}),Object(et["a"])(),Object(st["a"])(t=>{return r.consigs=t,r})).subscribe(t=>a(t),t=>n(t))})}}class At{constructor(t,e,s,a,n){this.mosaicId=t,this.ownerAddress=e,this.ownerPublicKey=s,this.divisibility=a,this.hash=n}}class _t{constructor(t,e){this.mosaicId=t,this.aggregate=e}}class Ct{constructor(t){this.nemNode=t,this.mosaicHttp=new tt["MosaicHttp"](t.endpoint),this.listenerWrapper=new dt(t.wsEndpoint)}async loadMosaicInfo(t){return new Promise((e,s)=>{this.mosaicHttp.getMosaic(new tt["MosaicId"](t)).pipe(Object(st["a"])(e=>new At(t,e.owner.address.plain(),e.owner.publicKey,e.divisibility))).subscribe(t=>e(t),t=>s(t))})}createMosaicDefinitionTxAggregate(t,e){tt["Account"].createFromPrivateKey(t,this.nemNode.network);return new _t("",void 0)}createMosaicSupplyChangeTxAggregate(t,e,s){tt["Account"].createFromPrivateKey(t,this.nemNode.network)}}class xt{constructor(t,e,s,a){this.namespace=t,this.namespaceId=e,this.ownerAddress=s,this.ownerPublicKey=a}}class Ht{constructor(t){this.nemNode=t,this.transactionHttp=new tt["TransactionHttp"](t.endpoint),this.namespaceHttp=new tt["NamespaceHttp"](t.endpoint),this.listenerWrapper=new dt(t.wsEndpoint)}async loadNamespace(t){return new Promise((e,s)=>{const a=new tt["NamespaceId"](t);this.namespaceHttp.getNamespace(a).pipe(Object(st["a"])(t=>{return console.log("item",t),t}),Object(it["a"])(t=>t.levels.length>0),Object(st["a"])(e=>new xt(t,e.levels[0].toHex(),e.owner.address.plain(),e.owner.publicKey))).subscribe(t=>e(t),t=>{this._errorNotFound(JSON.parse(t.message))?e(void 0):s(t)})})}async loadNamespacesFromAccount(t){return new Promise((e,s)=>{const a=tt["Address"].createFromRawAddress(t);this.namespaceHttp.getNamespacesFromAccount(a).pipe(Object(st["a"])(t=>t.filter(t=>t.levels.length>0).map(t=>new xt(name,t.levels[0].toHex(),t.owner.address.plain(),t.owner.publicKey)))).subscribe(t=>{console.log("loadNamespacesFromAccount",t),e(t)},t=>s(t))})}async createSubNamespace(t,e,s){return new Promise((a,n)=>{const o=tt["RegisterNamespaceTransaction"].createSubNamespace(tt["Deadline"].create(),t,e,this.nemNode.network),r=tt["Account"].createFromPrivateKey(s,this.nemNode.network),i=r.sign(o,this.nemNode.networkGenerationHash);console.log("createSubNamespace",o,i),this.listenerWrapper.loadStatus(r.address.plain(),i.hash).then(t=>a(t)).catch(t=>n(t)),this.transactionHttp.announce(i).subscribe(t=>console.log(t),t=>n(t))})}async registNamespaceToAddress(t,e,s){return new Promise((a,n)=>{const o=new tt["NamespaceId"](t),r=tt["Address"].createFromRawAddress(e),i=tt["AliasTransaction"].createForAddress(tt["Deadline"].create(),tt["AliasActionType"].Link,o,r,this.nemNode.network),c=tt["Account"].createFromPrivateKey(s,this.nemNode.network),l=c.sign(i,this.nemNode.networkGenerationHash);this.listenerWrapper.loadStatus(c.address.plain(),l.hash).then(t=>a(t)).catch(t=>n(t)),this.transactionHttp.announce(l).subscribe(t=>console.log("registeNamespaceToAddress",i,t),t=>n(t))})}createNamespaceTxAggregate(t,e,s){tt["Account"].createFromPrivateKey(t,this.nemNode.network)}createMosaicToNamespaceTxAggregate(t,e,s){tt["Account"].createFromPrivateKey(t,this.nemNode.network)}_errorNotFound(t){return"statusCode"in t&&404===t.statusCode}}class kt{constructor(t,e,s,a,n){this.host=t,this.port=s,this.network=a,this.networkGenerationHash=n,this.endpoint=`${t}:${s}`,this.wsEndpoint=`${e}:${s}`}}const St="https://catapult-test.opening-line.jp",Tt="wss://catapult-test.opening-line.jp",Ot="3001",jt=Number("144"),Nt="453052FDC4EB23BF0D7280C103F7797133A633B68A81986165B76FCE248AB235",Mt=new kt(St,Tt,Ot,jt,Nt),It=new ot(Mt),Lt=new ht(Mt),Pt=new ft(Mt),Ft=new Ct(Mt),Et=new Ht(Mt),Ut={LoadBalanceUseCase:new Y(It,Et),LoadWalletUseCase:new V(It),SendCoinUseCase:new Z(Lt,It),LoadTransactionHistoryUseCase:new X(Lt,It),AssetExchangeUseCase:new Q(Lt,It,Pt,Ft,Et)};var Rt=s("ce5b"),Kt=s.n(Rt);s("bf40");a["default"].use(Kt.a),a["default"].use(q.a,{defaultType:"bottom",duration:3e3,wordWrap:!0,width:"280px"}),a["default"].use(J.a),a["default"].config.productionTip=!1,new a["default"]({provide:Ut,router:$,store:B,vuetify:new Kt.a,render:t=>t(l)}).$mount("#app")},dc9d:function(t,e,s){"use strict";var a=s("89d8"),n=s.n(a);n.a}});
//# sourceMappingURL=app.6cce05d1.js.map